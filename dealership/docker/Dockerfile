FROM amazoncorretto:17

WORKDIR /app

COPY app.jar /app/dealership-service.jar

EXPOSE 8080

ENV SPRING_APPLICATION_NAME=dealership \
    EUREKA_CLIENT_SERVICEURL_DEFAULTZONE=http://localhost:8761/eureka \
    RESILIENCE4J_CIRCUITBREAKER_INSTANCES_VALORTOTAL_REGISTER_HEALTH_INDICATOR=true \
    RESILIENCE4J_CIRCUITBREAKER_INSTANCES_VALORTOTAL_MINIMUM_NUMBER_OF_CALLS=1 \
    RESILIENCE4J_CIRCUITBREAKER_INSTANCES_VALORTOTAL_SLIDING_WINDOW_SIZE=3 \
    RESILIENCE4J_CIRCUITBREAKER_INSTANCES_VALORTOTAL_WAIT_DURATION_IN_OPEN_STATE_SECONDS=1000

ENTRYPOINT ["java", "-jar", "/app/dealership-service.jar"]

CMD ["--server.port=8080"]
